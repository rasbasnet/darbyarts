{"version":3,"file":"static/js/127.c5cf5250.chunk.js","mappings":"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","sources":["../node_modules/@stripe/stripe-js/dist/index.mjs","services/payments.ts"],"sourcesContent":["var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"3.4.1\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar onErrorListener = null;\nvar onLoadListener = null;\n\nvar onError = function onError(reject) {\n  return function () {\n    reject(new Error('Failed to load Stripe.js'));\n  };\n};\n\nvar onLoad = function onLoad(resolve, reject) {\n  return function () {\n    if (window.Stripe) {\n      resolve(window.Stripe);\n    } else {\n      reject(new Error('Stripe.js not available'));\n    }\n  };\n};\n\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      } else if (script && onLoadListener !== null && onErrorListener !== null) {\n        var _script$parentNode;\n\n        // remove event listeners\n        script.removeEventListener('load', onLoadListener);\n        script.removeEventListener('error', onErrorListener); // if script exists, but we are reloading due to an error,\n        // reload script to trigger 'load' event\n\n        (_script$parentNode = script.parentNode) === null || _script$parentNode === void 0 ? void 0 : _script$parentNode.removeChild(script);\n        script = injectScript(params);\n      }\n\n      onLoadListener = onLoad(resolve, reject);\n      onErrorListener = onError(reject);\n      script.addEventListener('load', onLoadListener);\n      script.addEventListener('error', onErrorListener);\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  }); // Resets stripePromise on error\n\n  return stripePromise[\"catch\"](function (error) {\n    stripePromise = null;\n    return Promise.reject(error);\n  });\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\nvar stripePromise$1;\nvar loadCalled = false;\n\nvar getStripePromise = function getStripePromise() {\n  if (stripePromise$1) {\n    return stripePromise$1;\n  }\n\n  stripePromise$1 = loadScript(null)[\"catch\"](function (error) {\n    // clear cache on error\n    stripePromise$1 = null;\n    return Promise.reject(error);\n  });\n  return stripePromise$1;\n}; // Execute our own script injection after a tick to give users time to do their\n// own script injection.\n\n\nPromise.resolve().then(function () {\n  return getStripePromise();\n})[\"catch\"](function (error) {\n  if (!loadCalled) {\n    console.warn(error);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now(); // if previous attempts are unsuccessful, will re-load script\n\n  return getStripePromise().then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","import { loadStripe, Stripe } from '@stripe/stripe-js';\n\nconst publishableKey = process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY;\nconst apiBaseUrl = (process.env.REACT_APP_API_BASE_URL ?? '').replace(/\\/$/, '');\n\nexport type StripeCheckoutItem = {\n  posterId: string;\n  quantity: number;\n};\n\nexport type StripeCheckoutRequest = {\n  items: StripeCheckoutItem[];\n};\n\ntype StripeCheckoutResponse = {\n  sessionId?: string;\n  error?: string;\n};\n\nlet stripePromise: Promise<Stripe | null> | null = null;\n\nconst getStripe = () => {\n  if (!publishableKey) {\n    throw new Error('Stripe publishable key is not configured.');\n  }\n\n  if (!stripePromise) {\n    stripePromise = loadStripe(publishableKey);\n  }\n\n  return stripePromise;\n};\n\nexport const beginStripeCheckout = async ({ items }: StripeCheckoutRequest) => {\n  if (!Array.isArray(items) || items.length === 0) {\n    throw new Error('No items provided for checkout.');\n  }\n\n  const stripe = await getStripe();\n\n  if (!stripe) {\n    throw new Error('Unable to initialise Stripe.');\n  }\n\n  const endpoint = apiBaseUrl ? `${apiBaseUrl}/api/stripe/create-checkout-session` : '/api/stripe/create-checkout-session';\n\n  const response = await fetch(endpoint, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ items })\n  });\n\n  const contentType = response.headers.get('content-type') ?? '';\n  if (!contentType.includes('application/json')) {\n    throw new Error('Payment service returned an unexpected response. Please try again later.');\n  }\n\n  const data = (await response.json()) as StripeCheckoutResponse;\n\n  if (!response.ok || !data.sessionId) {\n    throw new Error(data.error ?? 'Unable to create Stripe checkout session.');\n  }\n\n  const result = await stripe.redirectToCheckout({ sessionId: data.sessionId });\n\n  if (result.error) {\n    throw new Error(result.error.message);\n  }\n};\n"],"names":["stripePromise$1","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","injectScript","params","queryString","advancedFraudSignals","script","document","createElement","src","concat","headOrBody","head","body","Error","appendChild","stripePromise","onErrorListener","onLoadListener","loadScript","Promise","resolve","reject","window","Stripe","console","warn","scripts","querySelectorAll","i","length","test","findScript","_script$parentNode","removeEventListener","parentNode","removeChild","onLoad","onError","addEventListener","error","loadCalled","getStripePromise","then","publishableKey","process","apiBaseUrl","_process$env$REACT_AP","replace","getStripe","_len","arguments","args","Array","_key","startTime","Date","now","maybeStripe","stripe","apply","undefined","_registerWrapper","name","version","registerWrapper","initStripe","loadStripe","beginStripeCheckout","async","_response$headers$get","items","_ref","isArray","endpoint","response","fetch","method","headers","JSON","stringify","get","includes","data","json","_data$error","ok","sessionId","result","redirectToCheckout","message"],"sourceRoot":""}